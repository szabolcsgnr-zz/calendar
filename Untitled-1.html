<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Calendar</title>

<style>
* { margin: 0; padding: 0;}

body, html { height:100%; }

#evCanvas {
    position:absolute;
    width:100%;
    height:100%;

}


.menu {
    position:absolute;
    width:120px;
    height:60px;
	bottom:20px;
	left:30%;
	z-index:2;
	//background:rgba(255,255,204,1);

}
#prefIcon{

	
	
	-webkit-transition-duration: 1s;
    -moz-transition-duration: 1s;
    -o-transition-duration: 1s;
    transition-duration: 1s;
     
    -webkit-transition-property: -webkit-transform;
    -moz-transition-property: -moz-transform;
    -o-transition-property: -o-transform;
    transition-property: transform;
     
    overflow:hidden;

	}
#prefIcon:hover{
	-webkit-transform:rotate(180deg);
    -moz-transform:rotate(180deg);
    -o-transform:rotate(180deg);
	
	}
	
#menuHelp{
	font-family: Arial, Helvetica, sans-serif;
	font-size: 12px;
	font-style: italic;
	font-weight: normal;
	color: rgba(204,204,204,1);
	text-align: center;
	
	}
#popUpBox{ 	
	
	position:absolute; 
	top:10%; 
	left:30%; 
	width:300;
	height:300px;	
	z-index:5;
}
							
</style>
</head>

<body onload="init()">
<div id="popUpBox">

</div>
<div class="menu" >
<a href="#">
<table onmouseout="delSugoText()">
<tr>
	<td width="40px" onclick="prefBox()" onmouseover="prefSugo()" >
<img src="imgcontents/preficoncircle.png" title="Beállítások" id="prefIcon"  width="40px" height="40px"  >
	</td>
    <td width="40px" onclick="" onmouseover="envSugo()">
<img src="imgcontents/envelope.png" title="Üzenetek" id="envelopeIcon"  width="40px" height="40px"  >
	</td>
    <td  width="40px"  onmouseover="profSugo()">
    <img src="imgcontents/proficon.png" title="Profil" id="profilIcon"  width="40px" height="40px"  >
   
    </td>
  
</tr>

<tr>
	<td id="menuHelp" colspan="3" width="100%">

	</td>
</tr>
</table>
</a>
</div>

<canvas id="evCanvas" onclick="popUp()" onmousedown="dragEventsScroll()" onmouseup="dragEventsScrollend()">

Your browser does not support the HTML5 canvas tag.
</canvas>


<script>
var c=document.getElementById("evCanvas");
var ctx=c.getContext("2d");
var eventNames=new Array();
var eventDates=new Array();

var xmlhttp;

var eltolasX=0;
var eltolasXseb=-1;
var animationOn=1;

eventDates[0]= "ma 2 kor";
eventDates[1]= "ma 3 kor";
eventDates[2]= "holnap reggel 8-kor";
eventDates[3]= "holnap reggel 10-kor";
eventDates[4]= "holnap";
eventDates[5]= "holnap után";
eventDates[6]= "január 27.";
eventDates[7]= "holnap reggel 10-kor";
eventDates[8]= "holnap";
eventDates[9]= "holnap után";
eventDates[10]= "január 27.";

var coordinatesX=new Array();
var coordinatesY=new Array();
var coordinatesZ=new Array();
var txtSize=new Array();
var mousePos;

var inFocusName;
var prevZ;
var prefOpen=0;
function init() {
 	ctx.canvas.width  = window.innerWidth;
  	ctx.canvas.height = window.innerHeight;
	initEvents();
}

function initEvents(){
	for(i=0; i<8; i++){
		eventNames[i]="eventName"+i;	
	}
	calculatePositions(eventNames);
}
	
function calculatePositions(eventNames){
		for(i=0; i<eventNames.length;i++){
			eventNames[i];
			
			var x; 
			var y;

		
				x=Math.floor((Math.random()* window.innerWidth/1.5)+100);
				y=Math.floor((Math.random()* window.innerHeight/1.5)+100);
				for(elozo=0; elozo<i;elozo++){
					if(Math.abs(x-coordinatesX[elozo])<300){
						if(Math.abs(y-coordinatesY[elozo])<50){
							calculatePositions(eventNames);
							return;
							}
						
						}}
			
			
			
			coordinatesX[i]=x;
			coordinatesY[i]=y;
			coordinatesZ[i]=i+1;
			
			}
		redraw();	
			
		
}

window.setInterval("eltolasSzamitas()",70);

function eltolasSzamitas(){
		
		if (eltolasX>100){
			eltolasXseb=-1;
			}
		if (eltolasX<-100){
			eltolasXseb=+1;
			}
			eltolasX+=eltolasXseb;
			
			redraw();
			
	}
function redraw(){
	
	ctx.clearRect ( 0 , 0 ,  window.innerWidth,  window.innerHeight);
	c.width = c.width;
		for(i=0; i<eventNames.length;i++){
			var meret=70-9*coordinatesZ[i];
			if(meret<10){meret=10;}
			ctx.font=meret+"px Arial";
			var r=0,g,b=194;
			g=Math.floor(50*coordinatesZ[i]);
			if(g>190){
				g=190;
				b-=Math.floor(10*coordinatesZ[i]);
				if(b<0){
					b=0;
					r+=Math.floor(10*coordinatesZ[i]);
					}
				}
			ctx.fillStyle = "rgb("+r+", "+g+", "+b+")";
			ctx.fillText(eventNames[i],coordinatesX[i]+eltolasX,coordinatesY[i]);
			var metrics = ctx.measureText(eventNames[i]);
    	var txtwidth = metrics.width;
		txtSize[i]=txtwidth;
			
			ctx.font=30/coordinatesZ[i]+"px Arial";
			ctx.fillText(eventDates[i],coordinatesX[i]+eltolasX,coordinatesY[i]+30/coordinatesZ[i]);
			
		}
	
}


function getMousePos(c, evt) {
	
        var rect = c.getBoundingClientRect();
        return {
          x: evt.clientX - rect.left,
          y: evt.clientY - rect.top
        };
      }

c.addEventListener('mousemove', function(evt) {
        mousePos = getMousePos(c, evt);
		eventsFocus();
      
      }, false);

function eventsFocus(){

	outFocus();
	var valami;
	for(i=0;i<eventNames.length;i++){

	
	
		if(mousePos.x>coordinatesX[i]+eltolasX){
			if(mousePos.x<coordinatesX[i]+txtSize[i]+eltolasX){
				if( mousePos.y>coordinatesY[i]-70/coordinatesZ[i]){
					if( mousePos.y<coordinatesY[i]){
						//document.getElementById("menu").innerHTML=eventNames[i];
						inFocus(eventNames[i]);
						break;
					}
				}
		}
	}
	
	}

	
	
}
function inFocus(name){
	inFocusName=name;
	var index=eventNames.indexOf(name);
	prevZ=coordinatesZ[index];
	
	if(coordinatesZ[index]!=1){
		coordinatesZ[index]--;
		}
	redraw();
	
	}
function outFocus(){
	
	var index=eventNames.indexOf(inFocusName);
	coordinatesZ[index]=prevZ;
	redraw();
	
	}
	 var eltolasXsebtemp;
function popUp(){
	if (eltolasXseb!=0){
	eltolasXsebtemp=eltolasXseb;
	}else if(animationOn==1){
		eltolasXseb=eltolasXsebtemp;
		}
	
	document.getElementById("popUpBox").innerHTML="";
	var valami;
	for(i=0;i<eventNames.length;i++){

	
	
		if(mousePos.x>coordinatesX[i]+eltolasX){
			if(mousePos.x<coordinatesX[i]+txtSize[i]+eltolasX){
				if( mousePos.y>coordinatesY[i]-70/coordinatesZ[i]){
					if( mousePos.y<coordinatesY[i]){
						var xx;
						var yy;
						if (mousePos.x> window.innerWidth/2){xx=mousePos.x-300}else{xx=mousePos.x}
						if (mousePos.y> window.innerHeight/2){yy=mousePos.y-300}else{yy=mousePos.y}
						eltolasXseb=0;
						document.getElementById("popUpBox").innerHTML="<img src=\"imgcontents/popUp.png\" "+
						"width=\"300px\" height=\"300px\" style=\"position:absolute; top:0px;left:0px;z-index:-2;\" >"+
						"<div id=\"popUpBoxy\"></div>";
						initPopUp();
						break;
					}
				}
		}
	}
	
	}
}
function initPopUp(){
	document.getElementById("popUpBoxy").innerHTML="";

	xmlhttp=null;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("popUpBoxy").innerHTML=xmlhttp.responseText;
	document.getElementById("meetingName").innerHTML=inFocusName;
	document.getElementById("eventDateDisplay").innerHTML=eventDates[eventNames.indexOf(inFocusName)];
	
    }
  }
xmlhttp.open("GET","textcontents/popup.txt",true);
xmlhttp.send();
}
	
	

function prefBox(){
	
	if (prefOpen==1){
		document.getElementById("popUpBox").innerHTML="";
		prefOpen=0;
		return;
		}
	prefOpen=1;
	document.getElementById("popUpBox").innerHTML="";
	
						
				
						document.getElementById("popUpBox").innerHTML="<img src=\"imgcontents/popUp.png\" "+
						"width=\"300px\" height=\"300px\" style=\"position:absolute; top:0px;left:0px;z-index:-2;\" >"+
						"<div id=\"popUpBoxy\"></div>";
	
	xmlhttp=null;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("popUpBoxy").innerHTML=xmlhttp.responseText;
	
	if (eltolasXseb!=0){
		document.getElementById("animation").checked=true;
		}
    }
  }
xmlhttp.open("GET","textcontents/prefbox.txt",true);
xmlhttp.send();
	
	}
function animvalt(){
	
	if(document.getElementById("animation").checked==true){
	animationOn=1;
	eltolasXseb=1;
	}else{
			animationOn=0;
			eltolasXseb=0;
		}
	}
	
function prefSugo(){
	document.getElementById("menuHelp").innerHTML="";
	document.getElementById("menuHelp").innerHTML="Beállítások";
	}
function envSugo(){
	document.getElementById("menuHelp").innerHTML="";
	document.getElementById("menuHelp").innerHTML="Üzenetek";
	}
function profSugo(){
	document.getElementById("menuHelp").innerHTML="";
	document.getElementById("menuHelp").innerHTML="Profil";
	}
function delSugoText(){
	document.getElementById("menuHelp").innerHTML="";
	}
</script>

<script>
var prefPaneltmp;
var colorChangePanelon=0;
function changeBackground(){
    
	if(colorChangePanelon==0){
	colorChangePanelon=1;
	document.getElementById("popUpBoxy").style.width="200px";
	 prefPaneltmp=document.getElementById("popUpBoxy").innerHTML;
	}else{
		document.getElementById("popUpBoxy").innerHTML=prefPaneltmp;
		document.getElementById("popUpBoxy").style.width="100px";
		colorChangePanelon=0;
		if (eltolasXseb!=0){
		document.getElementById("animation").checked=true;
		}
		return;
		}
	xmlhttp=null;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
	document.getElementById("popUpBoxy").innerHTML="<table><tr><td style=\" vertical-align:text-top;\">"+
	prefPaneltmp+"</td><td>"+xmlhttp.responseText+"</td></tr></table>";
	
	if (eltolasXseb!=0){
		document.getElementById("animation").checked=true;
		}
    }
  }
xmlhttp.open("GET","textcontents/backgrdchange.txt",true);
xmlhttp.send();
	
	}
	
function changeBackgroundToColor(color){
	switch(color){
		case 0:
		document.getElementById("evCanvas").style.background="";
	document.getElementById("evCanvas").style.background="black";
	break;
	case 1:
	document.getElementById("evCanvas").style.background="";
	document.getElementById("evCanvas").style.background="grey";
	break;
	case 2:
	document.getElementById("evCanvas").style.background="";
	document.getElementById("evCanvas").style.background="azure";
	break;
	case 3:
	document.getElementById("evCanvas").style.background="";
	document.getElementById("evCanvas").style.background="white";
	break;
	case 4:
	document.getElementById("evCanvas").style.background="";
	document.getElementById("evCanvas").style.background="red";
	break;
	}
}

var dragBeginX;
function dragEventsScroll(){
	dragBeginX=mousePos.x;
	dragTimer=setInterval("dragReload()",70);
	}
	
function dragReload(){
		for(i=0;i<eventNames.length;i++){
			coordinatesX[i]-=dragBeginX-mousePos.x;
			}
			dragBeginX=mousePos.x;
	}
function dragEventsScrollend(){
	window.clearInterval(dragTimer);
	}
	
</script>


</body>
</html>
